# load established panels and trans to GR obj


library(dplyr)
library(magrittr)
library(stringr)
load("Rdata/exon_lib_.Rdata")


# get panel genes ---------------------------------------------------------

## NCC-150
NCC150 = "ACVR2A AKT1 AKT2 ALK APC AR ARAF ARID1A ARID2 ATM ATR AXIN1 BARD1 BCL2L11 BIRC5 BRAF BRCA1 BRCA2 BRIP1 C11orf30 CBL CCND1 CCND2 CCNE1 CD274 CDH1 CDK12 CDK4 CDK6 CDKN1B CDKN2A CHEK1 CHEK2 CREBBP CRKL CTNNB1 CYP2C19 CYP2D6 DDR2 DPYD EGFR EP300 EPHB1 ERBB2 ERBB3 ERBB4 ERRFI1 ESR1 EZH2 FAM135B FAT1 FBXW7 FGF19 FGFR1 FGFR2 FGFR3 FLT1 FLT3 FLT4 GATA3 GLI3 GNA11 GNAQ GNAS HNF1A HRAS IDH1 IDH2 IRS2 JAK2 JAK3 KDR KEAP1 KIT KMT2A KRAS LRP1B MAP2K1 MAP2K2 MAP2K4 MAP3K1 MCL1 MET MLH1 MRE11A MSH2 MSH6 MTOR MYC MYCL MYCN NF1 NFE2L2 NKX2-1 NOTCH1 NOTCH2 NOTCH3 NRAS NRG1 NRG3 NTRK1 NTRK2 NTRK3 PALB2 PDCD1LG2 PDGFRA PDGFRB PIK3CA PIK3R1 PREX2 PTCH1 PTEN PTK2 PTPN11 RAD50 RAF1 RB1 RBM10 RET RICTOR RIT1 RNF43 ROS1 RUNX1T1 SETD2 SLIT2 SMAD2 SMAD3 SMAD4 SMARCA2 SMARCA4 SMO SOX2 SPEN SPTA1 SRC STK11 TBX3 TCF7L2 TERT TGFBR2 TP53 TPMT TSC1 TSC2 UGT1A1 VEGFA VHL ZNF217 ZNF703" %>% 
  str_split("\\s") %>% unlist() %>% unique %>% sort()

## Plasma SELECT
PlSe = "AKT1 CDK4 FLT3 MYCN PTCH1
ALK CDK6 GNAS NPM1 PTEN
AR CDKN2A HRAS NRAS RB1
ATM CTNNB1 IDH1 NTRK1 RET
BRAF DNMT3A IDH2 NTRK2 RNF43
BRCA1 EGFR JAK2 NTRK3 ROS1
BRCA2 ERBB2 KIT PALB2 TERT
BRCA2 ESR1 KRAS PIK3CA TP53
CCND1 EZH2 MAP2K1 PIK3CB TSC1
CCND2 FGFR1 MET PIK3R1 TSC2
CCND3 FGFR2 MTOR POLD1 VHL
CD274 FGFR3 MYC POLE
ALK ETV6 MYC PDGFRB ROS1
BCR FGFR1 NTRK1 RAF1
BRAF FGFR2 NTRK2 RARA
EGFR FGFR3 PDGFRA RET" %>%
  str_split('\\s+') %>% 
  unlist %>% unique %>% sort()


## F1Dx
F1Dx = "ABL1 BRAF CDKN1A EPHA3 FGFR4 IKZF1 MCL1 NKX2-1 PMS2 RNF43 TET2
ACVR1B BRCA1 CDKN1B EPHB1 FH INPP4B MDM2 NOTCH1 POLD1 ROS1 TGFBR2
AKT1 BRCA2 CDKN2A EPHB4 FLCN IRF2 MDM4 NOTCH2 POLE RPTOR TIPARP
AKT2 BRD4 CDKN2B ERBB2 FLT1 IRF4 MED12 NOTCH3 PPARG SDHA TNFAIP3
AKT3 BRIP1 CDKN2C ERBB3 FLT3 IRS2 MEF2B NPM1 PPP2R1A SDHB TNFRSF14
ALK BTG1 CEBPA ERBB4 FOXL2 JAK1 MEN1 NRAS PPP2R2A SDHC TP53
ALOX12B BTG2 CHEK1 ERCC4 FUBP1 JAK2 MERTK NT5C2 PRDM1 SDHD TSC1
AMER1 BTK CHEK2 ERG GABRA6 JAK3 MET NTRK1 PRKAR1A SETD2 TSC2
APC C11orf30 CIC ERRFI1 GATA3 JUN MITF NTRK2 PRKCI SF3B1 TYRO3
AR CALR CREBBP ESR1 GATA4 KDM5A MKNK1 NTRK3 PTCH1 SGK1 U2AF1
ARAF CARD11 CRKL EZH2 GATA6 KDM5C MLH1 P2RY8 PTEN SMAD2 VEGFA
ARFRP1 CASP8 CSF1R FAM46C GID4
KDM6A MPL PALB2 PTPN11 SMAD4 VHL
ARID1A CBFB CSF3R FANCA GNA11 KDR MRE11A PARK2 PTPRO SMARCA4 WHSC1
ASXL1 CBL CTCF FANCC GNA13 KEAP1 MSH2 PARP1 QKI SMARCB1 WHSC1L1
ATM CCND1 CTNNA1 FANCG GNAQ KEL MSH3 PARP2 RAC1 SMO WT1
ATR CCND2 CTNNB1 FANCL GNAS KIT MSH6 PARP3 RAD21 SNCAIP XPO1
ATRX CCND3 CUL3 FAS GRM3 KLHL6 MST1R PAX5 RAD51 SOCS1 XRCC2
AURKA CCNE1 CUL4A FBXW7 GSK3B
KMT2A
MTAP PBRM1 RAD51B SOX2 ZNF217
AURKB CD22 CXCR4 FGF10 H3F3A
KMT2D
MTOR PDCD1 RAD51C SOX9 ZNF703
AXIN1 CD274 CYP17A1 FGF12 HDAC1 KRAS MUTYH PDCD1LG2 RAD51D SPEN
AXL CD70 DAXX FGF14 HGF LTK MYC PDGFRA RAD52 SPOP

BAP1 CD79A DDR1 FGF19 HNF1A LYN MYCL PDGFRB RAD54L SRC
BARD1 CD79B DDR2 FGF23 HRAS MAF MYCN PDK1 RAF1 STAG2
BCL2 CDC73 DIS3 FGF3 HSD3B1 MAP2K1 MYD88 PIK3C2B RARA STAT3
BCL2L1 CDH1 DNMT3A FGF4 ID3 MAP2K2 NBN PIK3C2G RB1 STK11
BCL2L2 CDK12 DOT1L FGF6 IDH1 MAP2K4 NF1 PIK3CA RBM10 SUFU
BCL6 CDK4 EED FGFR1 IDH2 MAP3K1 NF2 PIK3CB REL SYK
BCOR CDK6 EGFR FGFR2 IGF1R MAP3K13 NFE2L2 PIK3R1 RET TBX3
BCORL1 CDK8 EP300 FGFR3 IKBKE MAPK1 NFKBIA PIM1 RICTOR TEK" %>% 
  str_split("\\s+") %>% unlist %>% 
  unique() %>% sort


## Grand360
Grand360 = "AKT1 ALK APC AR ARAF ARID1A ATM BRAF BRCA1 BRCA2
CCND1 CCND2 CCNE1 CDH1 CDK4 CDK6 CDKN2A CDKN2B CTNNB1 EGFR
ERBB2 ESR1 EZH2 FBXW7 FGFR1 FGFR2 FGFR3 GATA3 GNA11 GNAQ
GNAS HNF1A HRAS IDH1 IDH2 JAK2 JAK3 KIT KRAS MAP2K1
MAP2K2 MET MLH1 MPL MYC NF1 NFE2L2 NOTCH1 NPM1 NRAS
NTRK1 PDGFRA PIK3CA PTEN PTPN11 RAF1 RB1 RET RHEB RHOA
RIT1 ROS1 SMAD4 SMO SRC STK11 TERT TP53 TSC1 VHL" %>% 
  str_split("\\s+") %>% unlist %>% unique %>%  sort()

## get gene number
length(NCC150)# [1] 150
length(PlSe) # [1] 64
length(F1Dx) # [1] 309
length(Grand360) # [1] 70


## Zhang et al.
zhang = openxlsx::read.xlsx('data/Zhang_SupData1.xlsx', startRow = 2)$Gene

# trans to gr obj ---------------------------------------------------------

NCC_gr = exon_lib_[exon_lib_$Symbol %in% NCC150]
plse_gr = exon_lib_[exon_lib_$Symbol %in% PlSe]
F1Dx_gr = exon_lib_[exon_lib_$Symbol %in% F1Dx]
Gd360_gr = exon_lib_[exon_lib_$Symbol %in% Grand360]
Zhang_gr = exon_lib_[exon_lib_$Symbol %in% zhang]

## get gr length

length(NCC_gr$Symbol %>% unique())#[1] 150
length(plse_gr$Symbol %>% unique())#[1] 64
length(F1Dx_gr$Symbol %>% unique())#[1] 309
length(Gd360_gr$Symbol %>% unique())#[1] 70
length(Zhang_gr$Symbol %>% unique())
## all genes of panels were existed in gr object
save(NCC_gr, plse_gr, F1Dx_gr, Gd360_gr, file = "panels/est_panels.Rdata")
